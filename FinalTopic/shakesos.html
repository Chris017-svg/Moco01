<!doctype html>
<html lang="zh-Hant">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>æ–ä¸€æ–ç·Šæ€¥æ±‚åŠ©</title>
    <style>
        body{font-family:sans-serif;padding:20px}
        button,a{padding:12px 16px;font-size:16px}
        #call{
            display:none;
            margin-top:20px;
            background:#d60000;
            color:#fff;
            text-decoration:none
        }
        #info{
            margin-top:15px;
            font-size:15px;
            color:#b00000;
        }
        #value{
            margin-top:10px;
            font-size:16px;
        }
    </style>
</head>
<body>

<button id="start">é–‹å§‹åµæ¸¬</button>

<div id="value">ç›®å‰æ™ƒå‹•å¼·åº¦ï¼š0</div>

<div id="info">
    åµæ¸¬åˆ°ä¸æ˜åŠ‡çƒˆæ™ƒå‹•ï¼Œå¦‚æœ‰æ„å¤–è«‹å”åŠ©æ’¥æ‰“ç·Šæ€¥é€£çµ¡äºº
</div>

<a id="call" href="tel:0909032711">ğŸ“ æ’¥æ‰“ç·Šæ€¥è¯çµ¡äºº</a>

<script>
    const THRESHOLD = 18;
    let hit = 0;
    let started = false;

    document.getElementById("start").addEventListener("click", async () => {

        if (started) return;
        started = true;

        // iOS æˆæ¬Š
        if (
            typeof DeviceMotionEvent !== "undefined" &&
            typeof DeviceMotionEvent.requestPermission === "function"
        ) {
            const permission = await DeviceMotionEvent.requestPermission();
            if (permission !== "granted") {
                alert("æœªå…è¨±å‹•ä½œèˆ‡æ–¹å‘æ„Ÿæ¸¬");
                return;
            }
        }

        window.addEventListener("devicemotion", handleMotion, { passive: true });
    });

    function handleMotion(e) {
        const a = e.accelerationIncludingGravity || e.acceleration;
        if (!a) return;

        const x = a.x || 0;
        const y = a.y || 0;
        const z = a.z || 0;

        const mag = Math.sqrt(x*x + y*y + z*z);

        // å³æ™‚é¡¯ç¤ºæ•¸å€¼
        document.getElementById("value").textContent =
            "ç›®å‰æ™ƒå‹•å¼·åº¦ï¼š" + mag.toFixed(2);

        if (mag > THRESHOLD) {
            hit++;
            if (hit >= 2) {
                document.getElementById("call").style.display = "inline-block";
            }
        }
    }
</script>

</body>
</html>
